{"version":3,"file":"stats-workspace.element-Di20btYq.js","sources":["../../../assets/src/api/enums.gen.ts","../../../assets/src/section/stats/workspace/stats-workspace.element.ts"],"sourcesContent":["// This file is auto-generated by @hey-api/openapi-ts\n\n\nexport enum DirectionModelEnum {\n    ASCENDING = 'Ascending',\n    DESCENDING = 'Descending'\n}\n\nexport enum EventMessageTypeModelEnum {\n    DEFAULT = 'Default',\n    INFO = 'Info',\n    ERROR = 'Error',\n    SUCCESS = 'Success',\n    WARNING = 'Warning'\n}\n\nexport enum ResourceGroupTypeEnum {\n    IMAGES = 'Images',\n    SCRIPTS = 'Scripts',\n    STYLES = 'Styles',\n    OTHER = 'Other'\n}","import { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport { LitElement, css, customElement, html, property, repeat, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { DirectionModel, DirectionModelEnum, PageMetric, PagedResultPageMetricModel } from \"../../../api\";\r\nimport SustainabilityContext, { SUSTAINABILITY_CONTEXT } from \"../../../context/sustainability.context\";\r\nimport { UUIPaginationEvent } from \"@umbraco-cms/backoffice/external/uui\";\r\n\r\nconst elementName = \"stats-workspace\";\r\n\r\n@customElement(elementName)\r\nexport class StatsRootWorkspaceElement extends UmbElementMixin(LitElement) {\r\n\r\n  #sustainabilityContext: SustainabilityContext;\r\n\r\n  @state()\r\n  _data?: PagedResultPageMetricModel;\r\n\r\n  @property({ type: Boolean })\r\n  _loaded?: boolean = false\r\n\r\n  @state()\r\n  _sortingDesc = false;\r\n\r\n  @state()\r\n  _orderDirection: DirectionModel = DirectionModelEnum.DESCENDING;\r\n\r\n  @state()\r\n  _orderBy: string = \"RequestDate\";\r\n\r\n  @state()\r\n  _pageNumber = 1;\r\n\r\n  @state()\r\n  _pageSize = 10;\r\n\r\n  constructor() {\r\n    super();\r\n    \r\n    this.consumeContext(SUSTAINABILITY_CONTEXT, (instance) => {\r\n      this.#sustainabilityContext = instance;\r\n\r\n      this.observe(this.#sustainabilityContext.overviewData, (data) => {\r\n        if (!data) return;\r\n        this._loaded = true;\r\n        this._data = data;\r\n      });\r\n\r\n      this.#getStatsData();\r\n    });\r\n  }\r\n\r\n  #getStatsData() {\r\n    if (this._sortingDesc) {\r\n      this._orderDirection = DirectionModelEnum.DESCENDING;\r\n    }\r\n    else this._orderDirection = DirectionModelEnum.ASCENDING;\r\n\r\n    this.#sustainabilityContext.getOverviewData(this._orderDirection, this._orderBy, this._pageNumber, this._pageSize);\r\n  }\r\n\r\n  #onChange(event: UUIPaginationEvent) {\r\n    this._pageNumber = event.target.current;\r\n    this.#getStatsData();\r\n  }\r\n\r\n  private _sortingHandler(column: string) {\r\n    this._sortingDesc = this._orderBy === column ? !this._sortingDesc : false;\r\n    this._orderBy = column;\r\n    this._pageNumber = 1;\r\n\r\n    this.#getStatsData();\r\n  }\r\n\r\n  #renderPagination() {\r\n    if (this._data?.totalPages === 1) return;\r\n    return html`\r\n      <uui-pagination\r\n        .total=${this._data.totalPages}\r\n        .current=${this._data?.pageNumber}\r\n        @change=${this.#onChange}>\r\n      </uui-pagination>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    if (!this._loaded) {\r\n      return html`\r\n        <div id=\"loader-container\">\r\n          <uui-loader></uui-loader>\r\n        </div>`;\r\n    }\r\n    else {\r\n      return html`\r\n        <umb-body-layout headline=\"Stats\">\r\n          <div id=\"main\">\r\n            <uui-box>\r\n              <uui-table>\r\n                <uui-table-head>\r\n                  <uui-table-head-cell></uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"--uui-table-cell-padding: 0\">\r\n                    <uui-button\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('RequestDate')}>\r\n                      Last Run Date\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'RequestDate'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"--uui-table-cell-padding: 0\">\r\n                    <uui-button\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('CarbonRating')}>\r\n                      Carbon Rating\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'CarbonRating'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"text-align: right;\">\r\n                    <uui-button\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('TotalSize')}>\r\n                      Page Size\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'TotalSize'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"text-align: right;\">\r\n                    <uui-button\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('TotalEmissions')}>\r\n                      COâ‚‚ per page view\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'TotalEmissions'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>                \r\n                  </uui-table-head-cell>\r\n                </uui-table-head>\r\n                ${repeat(\r\n                  this._data.items,\r\n                  (item: PageMetric) => item,\r\n                  (item: PageMetric) => html`\r\n                    <uui-table-row>\r\n                      <uui-table-cell>\r\n                        <a href='/umbraco/section/content/workspace/document/edit/${item.nodeKey}'>\r\n                          ${item.nodeName}\r\n                        </a>\r\n                      </uui-table-cell>\r\n                      <uui-table-cell>\r\n                        ${item.requestDate}\r\n                      </uui-table-cell>\r\n                      <uui-table-cell>\r\n                        <uui-tag>\r\n                          ${item.carbonRating}\r\n                        </uui-tag>\r\n                      </uui-table-cell>\r\n                      <uui-table-cell style=\"text-align: right;\">\r\n                        ${(item.totalSize / 1024).toFixed(2)}KB\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell style=\"text-align: right;\">\r\n                        ${item.totalEmissions.toFixed(4)}g\r\n                      </uui-table-cell>\r\n                    </uui-table-row>\r\n                  `\r\n                )}\r\n              </uui-table>\r\n\r\n              ${this.#renderPagination()}\r\n            </uui-box>\r\n          </div>\r\n        </umb-body-layout>\r\n      `;\r\n    }\r\n  }\r\n\r\n  static styles = [\r\n    css`\r\n      #loader-container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin: 0 var(--uui-size-space-4);\r\n\t\t\t}\r\n    `\r\n  ]\r\n}\r\n\r\nexport default StatsRootWorkspaceElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    [elementName]: StatsRootWorkspaceElement;\r\n  }\r\n}"],"names":["DirectionModelEnum","_sustainabilityContext","_getStatsData","getStatsData_fn","_onChange","onChange_fn","_renderPagination","renderPagination_fn","elementName","StatsRootWorkspaceElement","UmbElementMixin","LitElement","__privateAdd","SUSTAINABILITY_CONTEXT","instance","__privateSet","__privateGet","data","__privateMethod","column","html","repeat","item","event","_a","_b","css","__decorateClass","state","property","customElement","StatsRootWorkspaceElement$1"],"mappings":"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"}