{"version":3,"file":"stats-workspace.element-snm_eYu_.js","sources":["../../../assets/src/api/enums.gen.ts","../../../assets/src/section/stats/workspace/stats-workspace.element.ts"],"sourcesContent":["// This file is auto-generated by @hey-api/openapi-ts\r\n\r\n\r\nexport enum DirectionModelEnum {\r\n    ASCENDING = 'Ascending',\r\n    DESCENDING = 'Descending'\r\n}\r\n\r\nexport enum EventMessageTypeModelEnum {\r\n    DEFAULT = 'Default',\r\n    INFO = 'Info',\r\n    ERROR = 'Error',\r\n    SUCCESS = 'Success',\r\n    WARNING = 'Warning'\r\n}\r\n\r\nexport enum ResourceGroupTypeEnum {\r\n    IMAGES = 'Images',\r\n    SCRIPTS = 'Scripts',\r\n    STYLES = 'Styles',\r\n    OTHER = 'Other'\r\n}","import { css, customElement, html, property, repeat, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { DirectionModel, DirectionModelEnum, PageMetric, PagedResultPageMetricModel } from \"../../../api\";\r\nimport SustainabilityContext, { SUSTAINABILITY_CONTEXT } from \"../../../context/sustainability.context\";\r\nimport { UUIPaginationEvent } from \"@umbraco-cms/backoffice/external/uui\";\r\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\r\n\r\nconst elementName = \"stats-workspace\";\r\n\r\n@customElement(elementName)\r\nexport class StatsRootWorkspaceElement extends UmbLitElement  {\r\n\r\n  #sustainabilityContext?: SustainabilityContext;\r\n\r\n  #localizeDateOptions: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    hour12: true\r\n  };\r\n\r\n  @state()\r\n  _data?: PagedResultPageMetricModel;\r\n\r\n  @property({ type: Boolean })\r\n  _loaded?: boolean = false\r\n\r\n  @state()\r\n  _sortingDesc = false;\r\n\r\n  @state()\r\n  _orderDirection: DirectionModel = DirectionModelEnum.DESCENDING;\r\n\r\n  @state()\r\n  _orderBy: string = \"RequestDate\";\r\n\r\n  @state()\r\n  _pageNumber = 1;\r\n\r\n  @state()\r\n  _pageSize = 10;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.consumeContext(SUSTAINABILITY_CONTEXT, (instance) => {\r\n      this.#sustainabilityContext = instance;\r\n\r\n      this.observe(this.#sustainabilityContext.overviewData, (data) => {\r\n        if (!data) return;\r\n        this._loaded = true;\r\n        this._data = data;\r\n      });\r\n\r\n      this.#getStatsData();\r\n    });\r\n  }\r\n\r\n  #getStatsData() {\r\n    if (this._sortingDesc) {\r\n      this._orderDirection = DirectionModelEnum.DESCENDING;\r\n    }\r\n    else this._orderDirection = DirectionModelEnum.ASCENDING;\r\n\r\n    this.#sustainabilityContext?.getOverviewData(this._orderDirection, this._orderBy, this._pageNumber, this._pageSize);\r\n  }\r\n\r\n  #onChange(event: UUIPaginationEvent) {\r\n    this._pageNumber = event.target.current;\r\n    this.#getStatsData();\r\n  }\r\n\r\n  private _sortingHandler(column: string) {\r\n    this._sortingDesc = this._orderBy === column ? !this._sortingDesc : false;\r\n    this._orderBy = column;\r\n    this._pageNumber = 1;\r\n\r\n    this.#getStatsData();\r\n  }\r\n\r\n  #renderPagination() {\r\n    if (this._data?.totalPages === 1) return;\r\n    return html`\r\n      <uui-pagination\r\n        .total=${this._data?.totalPages!}\r\n        .current=${this._data?.pageNumber!}\r\n        @change=${this.#onChange}>\r\n      </uui-pagination>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    if (!this._loaded) {\r\n      return html`\r\n        <div id=\"loader-container\">\r\n          <uui-loader></uui-loader>\r\n        </div>`;\r\n    }\r\n    else {\r\n      return html`\r\n        <umb-body-layout headline=\"Stats\">\r\n          <div id=\"main\">\r\n            <uui-box>\r\n              <uui-table>\r\n                <uui-table-head>\r\n                  <uui-table-head-cell></uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"--uui-table-cell-padding: 0\">\r\n                    <uui-button\r\n                      label=\"Last Run Date\"\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('RequestDate')}>\r\n                      Last Run Date\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'RequestDate'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"--uui-table-cell-padding: 0\">\r\n                    <uui-button\r\n                      label=\"Carbon Rating\"\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('CarbonRating')}>\r\n                      Carbon Rating\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'CarbonRating'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell>Scripts</uui-table-head-cell>\r\n                  <uui-table-head-cell>Images</uui-table-head-cell>\r\n                  <uui-table-head-cell>Styles</uui-table-head-cell>\r\n                  <uui-table-head-cell>Other</uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"text-align: right;\">\r\n                    <uui-button\r\n                      label=\"Page Size\"\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('TotalSize')}>\r\n                      Page Size\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'TotalSize'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                  <uui-table-head-cell style=\"text-align: right;\">\r\n                    <uui-button\r\n                      label=\"CO₂ per page view\"\r\n                      style=\"font-weight: bold; padding: var(--uui-size-4) 0\"\r\n                      @click=${() => this._sortingHandler('TotalEmissions')}>\r\n                      CO₂ per page view\r\n                      <uui-symbol-sort\r\n                        ?active=${this._orderBy === 'TotalEmissions'}\r\n                        ?descending=${this._sortingDesc}>\r\n                      </uui-symbol-sort>\r\n                    </uui-button>\r\n                  </uui-table-head-cell>\r\n                </uui-table-head>\r\n                ${repeat(\r\n                  this._data?.items!,\r\n                  (item: PageMetric) => item,\r\n                  (item: PageMetric) => html`\r\n                    <uui-table-row>\r\n                      <uui-table-cell>\r\n                        <a href='/umbraco/section/content/workspace/document/edit/${item.nodeKey}'>\r\n                          ${item.nodeName}\r\n                        </a>\r\n                      </uui-table-cell>\r\n                      <uui-table-cell>\r\n                        <umb-localize-date date=${item.requestDate} .options=${this.#localizeDateOptions}>\r\n                        </umb-localize-date>\r\n                      </uui-table-cell>\r\n                      <uui-table-cell>\r\n                        <sustainability-carbon-rating .carbonRating=${item.carbonRating}>\r\n                        </sustainability-carbon-rating>\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell>\r\n                        ${item.pageDataObject?.resourceGroups?.find(x => x.name === 'Scripts')?.resources?.length}\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell>\r\n                        ${item.pageDataObject?.resourceGroups?.find(x => x.name === 'Images')?.resources?.length}\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell>\r\n                        ${item.pageDataObject?.resourceGroups?.find(x => x.name === 'Styles')?.resources?.length}\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell>\r\n                        ${item.pageDataObject?.resourceGroups?.find(x => x.name === 'Other')?.resources?.length}\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell style=\"text-align: right;\">\r\n                        ${(item.totalSize / 1024).toFixed(2)}KB\r\n                      </uui-table-cell>\r\n\r\n                      <uui-table-cell style=\"text-align: right;\">\r\n                        ${item.totalEmissions.toFixed(4)}g\r\n                      </uui-table-cell>\r\n                    </uui-table-row>\r\n                  `\r\n                )}\r\n              </uui-table>\r\n\r\n              ${this.#renderPagination()}\r\n            </uui-box>\r\n          </div>\r\n        </umb-body-layout>\r\n      `;\r\n    }\r\n  }\r\n\r\n  static styles = [\r\n    css`\r\n      #loader-container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin: 0 var(--uui-size-space-4);\r\n\t\t\t}\r\n    `\r\n  ]\r\n}\r\n\r\nexport default StatsRootWorkspaceElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    [elementName]: StatsRootWorkspaceElement;\r\n  }\r\n}\r\n"],"names":["DirectionModelEnum","_sustainabilityContext","_localizeDateOptions","_getStatsData","getStatsData_fn","_onChange","onChange_fn","_renderPagination","renderPagination_fn","elementName","StatsRootWorkspaceElement","UmbLitElement","__privateAdd","SUSTAINABILITY_CONTEXT","instance","__privateSet","__privateGet","data","__privateMethod","column","html","repeat","_a","item","_d","_c","_b","x","_h","_g","_f","_e","_l","_k","_j","_i","_p","_o","_n","_m","event","css","__decorateClass","state","property","customElement","StatsRootWorkspaceElement$1"],"mappings":"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"}